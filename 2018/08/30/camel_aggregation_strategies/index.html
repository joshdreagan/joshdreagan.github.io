<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Camel Aggregation Strategies - Reagan&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Reagan&#039;s Blog"><meta name="msapplication-TileImage" content="/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Reagan&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="One of the many (many many many) extension points inside Apache Camel is the org.apache.camel.processor.aggregate.AggregationStrategy. These are used in everything from Content Enrichers to Splitters"><meta property="og:type" content="blog"><meta property="og:title" content="Camel Aggregation Strategies"><meta property="og:url" content="https://blog.joshdreagan.com/2018/08/30/camel_aggregation_strategies/"><meta property="og:site_name" content="Reagan&#039;s Blog"><meta property="og:description" content="One of the many (many many many) extension points inside Apache Camel is the org.apache.camel.processor.aggregate.AggregationStrategy. These are used in everything from Content Enrichers to Splitters"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://blog.joshdreagan.com/2018/08/30/camel_aggregation_strategies/post-bg.jpg"><meta property="article:published_time" content="2018-08-31T04:43:34.000Z"><meta property="article:modified_time" content="2021-01-14T22:53:28.839Z"><meta property="article:author" content="Josh Reagan"><meta property="article:tag" content="fuse"><meta property="article:tag" content="camel"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/2018/08/30/camel_aggregation_strategies/post-bg.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.joshdreagan.com/2018/08/30/camel_aggregation_strategies/"},"headline":"Reagan's Blog","image":["https://blog.joshdreagan.com/2018/08/30/camel_aggregation_strategies/post-bg.jpg"],"datePublished":"2018-08-31T04:43:34.000Z","dateModified":"2021-01-14T22:53:28.839Z","author":{"@type":"Person","name":"Josh Reagan"},"description":"One of the many (many many many) extension points inside Apache Camel is the org.apache.camel.processor.aggregate.AggregationStrategy. These are used in everything from Content Enrichers to Splitters"}</script><link rel="canonical" href="https://blog.joshdreagan.com/2018/08/30/camel_aggregation_strategies/"><link rel="alternate" href="/atom.xml" title="Reagan&#039;s Blog" type="application/atom+xml"><link rel="icon" href="/img/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-81075900-1" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-81075900-1');</script><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="Reagan&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-image"><span class="image"><img class="fill" src="/2018/08/30/camel_aggregation_strategies/post-bg.jpg" alt="Camel Aggregation Strategies"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-08-31T04:43:34.000Z" title="8/30/2018, 10:43:34 PM">2018-08-30</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-01-14T22:53:28.839Z" title="1/14/2021, 3:53:28 PM">2021-01-14</time></span></div></div><h1 class="title is-3 is-size-4-mobile">Camel Aggregation Strategies</h1><div class="content"><p>One of the many (many many many) extension points inside <a target="_blank" rel="noopener" href="http://camel.apache.org/">Apache Camel</a> is the <code>org.apache.camel.processor.aggregate.AggregationStrategy</code>. These are used in everything from <a target="_blank" rel="noopener" href="http://camel.apache.org/content-enricher.html">Content Enrichers</a> to <a target="_blank" rel="noopener" href="http://camel.apache.org/splitter.html">Splitters</a> to <a target="_blank" rel="noopener" href="http://camel.apache.org/aggregator2.html">Aggregators</a> and more. Since their use is so prevalent, I figured that I’d dedicate a whole blog post just for them. So here goes…<a id="more"></a></p>
<p>So what are AggregationStrategy’s anyway? Simple… they’re implementations of the <code>org.apache.camel.processor.aggregate.AggregationStrategy</code> that allow you to specify exactly how two exchanges will be merged. This specification can be as simple or as complex as you require for your use case. Maybe you just want to take the first response and ignore all others. Maybe you want to combine the XML bodies into a list and then merge a select few headers. The limit really is your imagination. But what do I mean by “merging exchanges”? Let’s take a look at a few concrete examples.</p>
<h2 id="Out-of-the-Box"><a href="#Out-of-the-Box" class="headerlink" title="Out of the Box"></a>Out of the Box</h2><p>For starters, there are several implementations that are included out of the box. You can use them “as-is” without writing any custom code at all. Let’s talk through a few of them with some potential use cases.</p>
<p>The first is the <code>org.apache.camel.processor.aggregate.UseLatestAggregationStrategy</code> implementation. It’s the default strategy for most Camel EIPs that accept aggregation strategies. So if you don’t specify any strategy, this is likely the one you’re using. Basically, it takes the last exchange it receives and just uses that (ignoring any others that may have been aggregated prior). One example use case for this would be when doing an <a target="_blank" rel="noopener" href="http://camel.apache.org/aggregator2.html">Aggregator</a>. Perhaps you’re receiving many messages as input, but you want to buffer them (giving the user time to send in corrections/updates), and then only send the latest message to the backend after some period of inactivity. That might look like below:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;useLatest&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.camel.processor.aggregate.UseLatestAggregationStrategy&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">camelContext</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://activemq.apache.org/camel/schema/spring&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">route</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">from</span> <span class="attr">uri</span>=<span class="string">&quot;direct:acceptUpdateableRequest&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aggregator</span> <span class="attr">strategyRef</span>=<span class="string">&quot;useLatest&quot;</span> <span class="attr">completionTimeout</span>=<span class="string">&quot;5000&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">correlationExpression</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">header</span>&gt;</span>UniqueRequestID<span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">correlationExpression</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">to</span> <span class="attr">uri</span>=<span class="string">&quot;direct:bufferedSendToBackend&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aggregator</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">route</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">camelContext</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>For the next use case, we’ll cover the (very similar) <code>org.apache.camel.processor.aggregate.UseOriginalAggregationStrategy</code> implementation. As the name would suggest, it “merges” two exchanges together by completely ignoring the new exchange and just taking the original. One example of where this might be useful is when doing a <a target="_blank" rel="noopener" href="http://camel.apache.org/multicast.html">Multicast</a>. Lets say I wanted to send a copy of a message off to multiple recipients, but really don’t care about their response. After the multicast is completed, I want to perform some transformation on the original message, and then return the result. Instead of rolling my own implementation, I could simply use the one provided. Something like this:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;useOriginal&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.camel.processor.aggregate.UseOriginalAggregationStrategy&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">camelContext</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://activemq.apache.org/camel/schema/spring&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">route</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">from</span> <span class="attr">uri</span>=<span class="string">&quot;direct:acceptRequest&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">multicast</span> <span class="attr">strategyRef</span>=<span class="string">&quot;useOriginal&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">to</span> <span class="attr">uri</span>=<span class="string">&quot;direct:recipient1&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">to</span> <span class="attr">uri</span>=<span class="string">&quot;direct:recipient2&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">multicast</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">to</span> <span class="attr">uri</span>=<span class="string">&quot;xslt:transformOriginal.xsl&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">route</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">camelContext</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>The next set of implementations, I’ll cover as a group. They are the <code>org.apache.camel.processor.aggregate.GroupedExchangeAggregationStrategy</code>, <code>org.apache.camel.processor.aggregate.GroupedMessageAggregationStrategy</code>, and <code>org.apache.camel.processor.aggregate.GroupedBodyAggregationStrategy</code> strategies. They will combine the exchanges into a list and then pass the list itself along to the next processor. They only differ by what they put in the list (ie, <code>List&lt;Exchange&gt;</code>, <code>List&lt;Message&gt;</code>, or <code>List&lt;Object&gt;</code>). So, for instance, if you wanted to split a message, process each individual part, and then combine the individual results back into a list, you could do so easily using a <a target="_blank" rel="noopener" href="http://camel.apache.org/splitter.html">Splitter</a> like below:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;listOfBody&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.camel.processor.aggregate.GroupedBodyAggregationStrategy&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">camelContext</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://activemq.apache.org/camel/schema/spring&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">route</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">from</span> <span class="attr">uri</span>=<span class="string">&quot;direct:acceptListRequestExpectingListResponse&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">split</span> <span class="attr">strategyRef</span>=<span class="string">&quot;listOfBody&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">simple</span>&gt;</span>$&#123;body&#125;<span class="tag">&lt;/<span class="name">simple</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">to</span> <span class="attr">uri</span>=<span class="string">&quot;direct:sendIndividualRequest&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">split</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">route</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">camelContext</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>The final implementation that I’ll cover for this section is the <code>org.apache.camel.util.toolbox.XsltAggregationStrategy</code>. It allows you to provide an XSLT that will be used to merge the original and new exchanges together. A great use case for this is when you want to <a target="_blank" rel="noopener" href="http://camel.apache.org/content-enricher.html">Enrich</a> an XML request with some extra data retrieved from a backend.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;xsltEnrichmentStrategy&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.camel.util.toolbox.XsltAggregationStrategy&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">&quot;/META-INF/xslt/EnrichIndexHtml.xsl&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">camelContext</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://activemq.apache.org/camel/schema/spring&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">route</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">from</span> <span class="attr">uri</span>=<span class="string">&quot;direct:acceptRequest&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">to</span> <span class="attr">uri</span>=<span class="string">&quot;language:constant:classpath:/META-INF/html/index.html&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">enrich</span> <span class="attr">strategyRef</span>=<span class="string">&quot;xsltEnrichmentStrategy&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">constant</span>&gt;</span>direct:fetchCds<span class="tag">&lt;/<span class="name">constant</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">enrich</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">route</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">camelContext</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Since this example is a little more complex, it requires more than just a code snippet to explain. So I’ve put together an example application and thrown it up on GitHub. Take a look… <a target="_blank" rel="noopener" href="https://github.com/joshdreagan/camel-xslt-enricher">https://github.com/joshdreagan/camel-xslt-enricher</a></p>
<p>It’s amazing how many use cases these “canned” aggregation strategies cover. But what if I they’re not quite exactly what you need?</p>
<h2 id="Semi-Custom"><a href="#Semi-Custom" class="headerlink" title="Semi-Custom"></a>Semi-Custom</h2><p>In this section, we’ll discuss what I call “semi-custom” strategies. Basically, they’re base/utility classes that make it easy for you to implement a custom strategy with very little Java code.</p>
<p>The first class we’ll talk about is the <code>org.apache.camel.processor.aggregate.AbstractListAggregationStrategy</code>. Similar to the grouping implementations mentioned above, the end result of this strategy is a list of items. The difference is that you have total control over what data gets placed in said list as well as where you pull it from. Here’s a very simple example implementation:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.apache.camel.examples;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.camel.Exchange;</span><br><span class="line"><span class="keyword">import</span> org.apache.camel.processor.aggregate.AbstractListAggregationStrategy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleListAggregationStrategy</span> <span class="keyword">extends</span> <span class="title">AbstractListAggregationStrategy</span>&lt;<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getValue</span><span class="params">(Exchange exchange)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> exchange.getIn().getHeader(<span class="string">&quot;MyAwesomeHeader&quot;</span>, String.class);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>If you need even more control over the aggregation, you can use the <code>org.apache.camel.util.toolbox.FlexibleAggregationStrategy</code>. The FlexibleAggregationStrategy is a fluent strategy builder that lets you define fairly complex aggregation strategy implementations using a very concise syntax. If you’re using the Java DSL to define your Camel routes (or are using any Java based bean wiring mechanism), you can just use the fluent builder directly. However, if you’re using it from the Spring DSL (using Spring’s XML bean definitions) it might be easier to wrapper it in a simple Java implementation. See below for an example:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.apache.camel.examples;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.camel.Exchange;</span><br><span class="line"><span class="keyword">import</span> org.apache.camel.model.language.SimpleExpression;</span><br><span class="line"><span class="keyword">import</span> org.apache.camel.processor.aggregate.AggregationStrategy;</span><br><span class="line"><span class="keyword">import</span> org.apache.camel.util.toolbox.AggregationStrategies;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CorrelationIdAggregationStrategy</span> <span class="keyword">implements</span> <span class="title">AggregationStrategy</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> AggregationStrategy delegate;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">FluentAggregationStrategy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    delegate = AggregationStrategies.flexible()</span><br><span class="line">            .storeInHeader(<span class="string">&quot;MyCorrelationID&quot;</span>)</span><br><span class="line">            .pick(<span class="keyword">new</span> SimpleExpression(<span class="string">&quot;$&#123;body&#125;&quot;</span>))</span><br><span class="line">    ;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Exchange <span class="title">aggregate</span><span class="params">(Exchange oldExchange, Exchange newExchange)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> delegate.aggregate(oldExchange, newExchange);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>You could then use your implementation like this:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;uuidEnrichmentStrategy&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.camel.examples.CorrelationIdAggregationStrategy&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">camelContext</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://activemq.apache.org/camel/schema/spring&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">route</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">from</span> <span class="attr">uri</span>=<span class="string">&quot;direct:acceptRequest&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">enrich</span> <span class="attr">strategyRef</span>=<span class="string">&quot;uuidEnrichmentStrategy&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">constant</span>&gt;</span>direct:fetchUuid<span class="tag">&lt;/<span class="name">constant</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">enrich</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">route</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">route</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">from</span> <span class="attr">uri</span>=<span class="string">&quot;direct:fetchUuid&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">beanType</span>=<span class="string">&quot;java.util.UUID&quot;</span> <span class="attr">method</span>=<span class="string">&quot;randomUUID&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">convertBodyTo</span> <span class="attr">type</span>=<span class="string">&quot;java.lang.String&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">route</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">camelContext</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Pretty powerful stuff! But what if you’re feeling even more imaginative?</p>
<h2 id="Custom"><a href="#Custom" class="headerlink" title="Custom"></a>Custom</h2><p>The last type of strategy that I’ll talk about is a “completely custom” implementation. This basically just means that you will implement the <code>org.apache.camel.processor.aggregate.AggregationStrategy</code> interface directly without using any helper base classes (which might restrict you in some ways). Because of this direct implementation, you are free to do literally anything you want.</p>
<p>One example that I whipped up for a customer a while back is what I called the “semi-streaming aggregation strategy”.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.apache.camel.examples;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"><span class="keyword">import</span> java.util.SortedSet;</span><br><span class="line"><span class="keyword">import</span> java.util.TreeSet;</span><br><span class="line"><span class="keyword">import</span> org.apache.camel.CamelContext;</span><br><span class="line"><span class="keyword">import</span> org.apache.camel.CamelContextAware;</span><br><span class="line"><span class="keyword">import</span> org.apache.camel.Exchange;</span><br><span class="line"><span class="keyword">import</span> org.apache.camel.Message;</span><br><span class="line"><span class="keyword">import</span> org.apache.camel.Processor;</span><br><span class="line"><span class="keyword">import</span> org.apache.camel.RuntimeCamelException;</span><br><span class="line"><span class="keyword">import</span> org.apache.camel.processor.aggregate.AggregateProcessor;</span><br><span class="line"><span class="keyword">import</span> org.apache.camel.processor.aggregate.AggregationStrategy;</span><br><span class="line"><span class="keyword">import</span> org.apache.camel.util.ExchangeHelper;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.InitializingBean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SemiStreamingAggregationStrategy</span> <span class="keyword">implements</span> <span class="title">AggregationStrategy</span>, <span class="title">CamelContextAware</span>, <span class="title">InitializingBean</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger log = LoggerFactory.getLogger(SemiStreamingAggregationStrategy.class);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String LAST_PROCESSED_INDEX = <span class="string">&quot;CamelAggregatorLastProcessedIndex&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> String aggregateProcessorId;</span><br><span class="line">  <span class="keyword">private</span> CamelContext camelContext;</span><br><span class="line">  <span class="keyword">private</span> String sequenceIdHeaderName;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Lazily initialized.</span></span><br><span class="line">  <span class="keyword">private</span> AggregateProcessor _aggregateProcessor;</span><br><span class="line">  <span class="keyword">private</span> Comparator&lt;Message&gt; _messageComparator;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getAggregateProcessorId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> aggregateProcessorId;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAggregateProcessorId</span><span class="params">(String aggregateProcessorId)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.aggregateProcessorId = aggregateProcessorId;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCamelContext</span><span class="params">(CamelContext camelContext)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.camelContext = camelContext;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> CamelContext <span class="title">getCamelContext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> camelContext;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getSequenceIdHeaderName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sequenceIdHeaderName;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSequenceIdHeaderName</span><span class="params">(String sequenceIdHeaderName)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.sequenceIdHeaderName = sequenceIdHeaderName;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> AggregateProcessor <span class="title">_aggregateProcessor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (_aggregateProcessor == <span class="keyword">null</span>) &#123;</span><br><span class="line">      _aggregateProcessor = camelContext.getProcessor(aggregateProcessorId, AggregateProcessor.class);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _aggregateProcessor;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> Comparator&lt;Message&gt; <span class="title">_messageComparator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (_messageComparator == <span class="keyword">null</span>) &#123;</span><br><span class="line">      _messageComparator = (Message t, Message t1) -&gt; t.getHeader(sequenceIdHeaderName, Comparable.class).compareTo(t1.getHeader(sequenceIdHeaderName, Comparable.class));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _messageComparator;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterPropertiesSet</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    Objects.requireNonNull(aggregateProcessorId, <span class="string">&quot;The aggregateProcessorId property must not be null.&quot;</span>);</span><br><span class="line">    Objects.requireNonNull(camelContext, <span class="string">&quot;The camelContext property must not be null.&quot;</span>);</span><br><span class="line">    Objects.requireNonNull(sequenceIdHeaderName, <span class="string">&quot;The sequenceIdHeaderName property must not be null.&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Exchange <span class="title">aggregate</span><span class="params">(Exchange oldExchange, Exchange newExchange)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    Exchange aggregateExchange = initializeAggregateExchange(oldExchange, newExchange);</span><br><span class="line">    log.info(String.format(<span class="string">&quot;Pending messages: [%s] messages&quot;</span>, aggregateExchange.getIn().getBody(SortedSet.class).size()));</span><br><span class="line"></span><br><span class="line">    appendMessage(aggregateExchange, newExchange.getIn());</span><br><span class="line"></span><br><span class="line">    findAndEmitSequencedMessages(aggregateExchange);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> aggregateExchange;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> Exchange <span class="title">initializeAggregateExchange</span><span class="params">(Exchange oldExchange, Exchange newExchange)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    Exchange aggregateExchange;</span><br><span class="line">    <span class="keyword">if</span> (oldExchange == <span class="keyword">null</span>) &#123;</span><br><span class="line">      aggregateExchange = ExchangeHelper.copyExchangeAndSetCamelContext(newExchange, camelContext);</span><br><span class="line">      SortedSet&lt;Message&gt; pendingMessages = <span class="keyword">new</span> TreeSet&lt;&gt;(_messageComparator());</span><br><span class="line">      aggregateExchange.getIn().setBody(pendingMessages);</span><br><span class="line">      aggregateExchange.setProperty(LAST_PROCESSED_INDEX, -<span class="number">1L</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      aggregateExchange = oldExchange;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> aggregateExchange;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">appendMessage</span><span class="params">(Exchange aggregateExchange, Message message)</span> </span>&#123;</span><br><span class="line">    log.info(String.format(<span class="string">&quot;Adding message: index [%s], body [%s]&quot;</span>, message.getHeader(sequenceIdHeaderName), message.getBody()));</span><br><span class="line">    aggregateExchange.getIn().getBody(SortedSet.class).add(message);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">findAndEmitSequencedMessages</span><span class="params">(Exchange aggregateExchange)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    SortedSet&lt;Message&gt; pendingMessages = aggregateExchange.getIn().getBody(SortedSet.class);</span><br><span class="line">    Long lastProcessedIndex = aggregateExchange.getProperty(LAST_PROCESSED_INDEX, Long.class);</span><br><span class="line"></span><br><span class="line">    Message currentMessage;</span><br><span class="line">    Long currentMessageIndex;</span><br><span class="line">    SortedSet&lt;Message&gt; messagesToBeEmitted = <span class="keyword">new</span> TreeSet&lt;&gt;(_messageComparator());</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">      currentMessage = pendingMessages.first();</span><br><span class="line">      currentMessageIndex = currentMessage.getHeader(sequenceIdHeaderName, Long.class);</span><br><span class="line">      <span class="keyword">if</span> (currentMessageIndex == lastProcessedIndex + <span class="number">1</span>) &#123;</span><br><span class="line">        messagesToBeEmitted.add(currentMessage);</span><br><span class="line">        pendingMessages.remove(currentMessage);</span><br><span class="line">        lastProcessedIndex = currentMessageIndex;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">while</span> (!pendingMessages.isEmpty());</span><br><span class="line">    <span class="keyword">if</span> (!messagesToBeEmitted.isEmpty()) &#123;</span><br><span class="line">      log.info(String.format(<span class="string">&quot;Messages to be emitted: [%s] messages&quot;</span>, messagesToBeEmitted.size()));</span><br><span class="line">      aggregateExchange.setProperty(LAST_PROCESSED_INDEX, lastProcessedIndex);</span><br><span class="line">      aggregateExchange.getIn().setBody(pendingMessages);</span><br><span class="line">      Exchange exchangeToBeEmitted = ExchangeHelper.copyExchangeAndSetCamelContext(aggregateExchange, camelContext);</span><br><span class="line">      exchangeToBeEmitted.getIn().setBody(messagesToBeEmitted);</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (Processor processor : _aggregateProcessor().next()) &#123;</span><br><span class="line">          processor.process(exchangeToBeEmitted);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeCamelException(e);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Here’s a link to the full source for your perusal: [<a target="_blank" rel="noopener" href="https://github.com/joshdreagan/camel-streaming-aggregation">https://github.com/joshdreagan/camel-streaming-aggregation</a>]. In this implementation, I was asked to do ordering aggregation of incoming messages. But as the messages came in, if the next sequential block was completed, the customer wanted those messages to be emitted at that time instead of waiting for the entire batch to complete. So, for example, if I got messages [1,3,5], those messages would be aggregated and stored in the aggregation repository. But then, when message [2] came in, messages [1,2,3] would be emitted/processed (while message [5] would remain in the repository). Finally, when message [4] came in, messages [4,5] would be emitted/processed. That’s about as custom as they come!</p>
<p>Hopefully this helps highlight some of the power and flexibility of Camel. Like I said at the beginning of this post, your imagination is the limit (or rather your use case). Enjoy!</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>Camel Aggregation Strategies</p><p><a href="https://blog.joshdreagan.com/2018/08/30/camel_aggregation_strategies/">https://blog.joshdreagan.com/2018/08/30/camel_aggregation_strategies/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Josh Reagan</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2018-08-30</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2021-01-14</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/fuse/">fuse</a><a class="link-muted mr-2" rel="tag" href="/tags/camel/">camel</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2019/05/30/streaming_in_the_cloud_with_camel_and_strimzi/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Streaming in the Cloud With Camel and Strimzi</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2018/03/02/camel_cxfrs_contract_first/"><span class="level-item">Camel CXFRS Contract First</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://www.gravatar.com/avatar/29313b56e332976a2383b911a27c15b2?s=128" alt="Josh Reagan"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Josh Reagan</p><p class="is-size-6 is-block">Software Engineer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Colorado, USA</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">26</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">20</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/joshdreagan" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/joshdreagan"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/joshdreagan"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="LinkedIn" href="https://www.linkedin.com/in/joshdreagan"><i class="fab fa-linkedin"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><figure class="media-left"><a class="image" href="/2025/06/19/bridging_apache_artemis_part_2/"><img src="/2025/06/19/bridging_apache_artemis_part_2/post-bg.jpg" alt="Bridging Apache Artemis - Part 2"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-06-19T21:17:51.000Z">2025-06-19</time></p><p class="title"><a href="/2025/06/19/bridging_apache_artemis_part_2/">Bridging Apache Artemis - Part 2</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2020/03/20/dropping_dups_with_camel/"><img src="/2020/03/20/dropping_dups_with_camel/post-bg.jpg" alt="Dropping Dups With Camel"></a></figure><div class="media-content"><p class="date"><time dateTime="2020-03-20T20:57:20.000Z">2020-03-20</time></p><p class="title"><a href="/2020/03/20/dropping_dups_with_camel/">Dropping Dups With Camel</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2019/10/14/artemis_disaster_recovery/"><img src="/2019/10/14/artemis_disaster_recovery/post-bg.jpg" alt="Artemis Disaster Recovery"></a></figure><div class="media-content"><p class="date"><time dateTime="2019-10-15T04:55:40.000Z">2019-10-14</time></p><p class="title"><a href="/2019/10/14/artemis_disaster_recovery/">Artemis Disaster Recovery</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2019/05/30/streaming_in_the_cloud_with_camel_and_strimzi/"><img src="/2019/05/30/streaming_in_the_cloud_with_camel_and_strimzi/post-bg.jpg" alt="Streaming in the Cloud With Camel and Strimzi"></a></figure><div class="media-content"><p class="date"><time dateTime="2019-05-30T23:23:43.000Z">2019-05-30</time></p><p class="title"><a href="/2019/05/30/streaming_in_the_cloud_with_camel_and_strimzi/">Streaming in the Cloud With Camel and Strimzi</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2018/08/30/camel_aggregation_strategies/"><img src="/2018/08/30/camel_aggregation_strategies/post-bg.jpg" alt="Camel Aggregation Strategies"></a></figure><div class="media-content"><p class="date"><time dateTime="2018-08-31T04:43:34.000Z">2018-08-30</time></p><p class="title"><a href="/2018/08/30/camel_aggregation_strategies/">Camel Aggregation Strategies</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2025/06/"><span class="level-start"><span class="level-item">June 2025</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/10/"><span class="level-start"><span class="level-item">October 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/05/"><span class="level-start"><span class="level-item">May 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/08/"><span class="level-start"><span class="level-item">August 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/03/"><span class="level-start"><span class="level-item">March 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/12/"><span class="level-start"><span class="level-item">December 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/08/"><span class="level-start"><span class="level-item">August 2017</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/03/"><span class="level-start"><span class="level-item">March 2017</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/01/"><span class="level-start"><span class="level-item">January 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/11/"><span class="level-start"><span class="level-item">November 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/10/"><span class="level-start"><span class="level-item">October 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/08/"><span class="level-start"><span class="level-item">August 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/07/"><span class="level-start"><span class="level-item">July 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/05/"><span class="level-start"><span class="level-item">May 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/02/"><span class="level-start"><span class="level-item">February 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/12/"><span class="level-start"><span class="level-item">December 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/10/"><span class="level-start"><span class="level-item">October 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/08/"><span class="level-start"><span class="level-item">August 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/05/"><span class="level-start"><span class="level-item">May 2015</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/04/"><span class="level-start"><span class="level-item">April 2015</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/activemq/"><span class="tag">activemq</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/amq/"><span class="tag">amq</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/artemis/"><span class="tag">artemis</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bpms/"><span class="tag">bpms</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/camel/"><span class="tag">camel</span><span class="tag">21</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cxf/"><span class="tag">cxf</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/datagrid/"><span class="tag">datagrid</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/fabric8/"><span class="tag">fabric8</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/feedhenry/"><span class="tag">feedhenry</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/fuse/"><span class="tag">fuse</span><span class="tag">20</span></a></div><div class="control"><a class="tags has-addons" href="/tags/infinispan/"><span class="tag">infinispan</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jboss/"><span class="tag">jboss</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jbpm/"><span class="tag">jbpm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kafka/"><span class="tag">kafka</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/karaf/"><span class="tag">karaf</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/narayana/"><span class="tag">narayana</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/openshift/"><span class="tag">openshift</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spring-boot/"><span class="tag">spring-boot</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/strimzi/"><span class="tag">strimzi</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/wildfly/"><span class="tag">wildfly</span><span class="tag">5</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.png" alt="Reagan&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2025 Josh Reagan</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>